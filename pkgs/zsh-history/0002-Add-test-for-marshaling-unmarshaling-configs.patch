From dd1606ba82e07850698a94106cc2e2f2d15608a0 Mon Sep 17 00:00:00 2001
From: Christian Kampka <christian@kampka.net>
Date: Sun, 13 Oct 2019 00:10:11 +0200
Subject: [PATCH 2/2] Add test for marshaling/unmarshaling configs

---
 config/config_test.go | 33 +++++++++++++++++++++++++++++++++
 1 file changed, 33 insertions(+)
 create mode 100644 config/config_test.go

diff --git a/config/config_test.go b/config/config_test.go
new file mode 100644
index 0000000..07db24f
--- /dev/null
+++ b/config/config_test.go
@@ -0,0 +1,33 @@
+package config
+
+import (
+    "path/filepath"
+    "io/ioutil"
+	"testing"
+    "os"
+)
+
+func TestMarshalDefaultConfig(t *testing.T) {
+    dir, err := ioutil.TempDir("", "history-test")
+    if err != nil {
+	    t.Error(err)
+    }
+    defer os.RemoveAll(dir)
+    
+    file := filepath.Join(dir, "config.toml")
+
+    // Loading the config for the first time
+    // creates the default and marshals it
+    err = Conf.LoadFile(file)
+    if err != nil {
+        t.Errorf("Failed to create default config file: %v", err) 
+    }
+
+    // Loading the config for the second time
+    // reads it from disk and unmarshals it
+    err = Conf.LoadFile(file)
+    if err != nil {
+        t.Errorf("Failed to load default config file: %v", err) 
+    }
+}
+
-- 
2.19.2

